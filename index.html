<!DOCTYPE HTML>
<html>
  <head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <script>
      //var earth;
      function initialize() {
        const countryFlags = new Map();
        // retrieves a map with all the countries.
        const countryCapitalCoords = new Map();
        fetch('https://restcountries.com/v3.1/all')
          .then(response => response.json())
          .then(data => {
            data.forEach(country => {
              const name = country.name.common;
              const capitalCoords = country.capital ? country.latlng : null;
              countryCapitalCoords.set(name, capitalCoords);
            });
            console.log(countryCapitalCoords);
          })
          .catch(error => console.error(error));

        fetch('https://flagcdn.com/en/codes.json')
          .then(response => response.json())
          .then(data => {
            for (const [code, name] of Object.entries(data)) {
              const flagUrl = `https://flagcdn.com/160x120/${code.toLowerCase()}.png`;
              countryFlags.set(name, flagUrl);
            }
            console.log(countryFlags);
            // Now you can use the countryFlags Map to display flags on a map
            // For example, if you're using Leaflet.js:
            const map = L.map('map', {
              center: [-29.50, 145],
              zoom: 3.5
            });
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: 'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
              maxZoom: 18
            }).addTo(map);

            for (const [name, flagUrl] of countryFlags.entries()) {
              const latlng = countryCapitalCoords.get(name);
              const marker = L.marker(latlng).addTo(map);
              marker.bindPopup(`<h3>${name}</h3><img src="${flagUrl}" alt="${name} flag">`);
            }
          })
          .catch(error => console.error(error));        
      }
    </script>
    <style>
      body{padding: 0; background-color: black; margin: 0;}
      #map {
        width: 100vw;
        height: 100vh; 
        position: relative;
      }  /*previous position: absolute*/
      /* Add a black background color to the top navigation */
      .topnav {
        background-color: #333;
        overflow: hidden;
        padding-inline-end: 12cm;
      }

      /* Style the links inside the navigation bar */
      .topnav a {
        float:right ;
        color: #f2f2f2;
        text-align: center;
        padding: 14px 30px;
        text-decoration: none;
        font-size: 17px;
      }

      /* Change the color of links on hover */
      .topnav a:hover {
        background-color: #ddd;
        color: black;
      }

      /* Add a color to the active/current link */
      .topnav a.active {
        background-color: #0449aa;
        color: white;
      }
    </style>
    <title>WebGL Earth API v2 examples: Rotating globe animation</title>
    <meta name="description" content="Free and open-source 3D digital globe for web and mobile devices. This example shows how to rotate the Earth in a beautiful animation.">
  </head>
  <body onload="initialize()">
    <!-- division for the world view map -->
    <div id="map"></div>
    <!-- Tool bar -->
    <div class="topnav">
      <a class="active" href="#home">Home</a>
      <a href="#contact">Contact</a>
      <a href="#about">About</a>
    </div>

    
    
  </body>
</html>
